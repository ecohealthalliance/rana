template(name="reportFormComplete")

  if type
    .report-form.space-btm-3
      section.title.rm-pad-btm.odd
        .container.name-action
          h1
            span.name #{study.name}
            if isInsert
              span.action New Report
            else if isUpdate
              span.action Update Report
            a.btn.btn-primary.btn-inline.study-link(href="{{pathFor route='editStudy' data=studyId}}") View Study
      if isPending
        section.approval.rm-pad.space-btm-3.gray
          .container
            a#approve-report.btn.btn-success.btn-inline.approve 
              span Approve Report
              i.fa.fa-check
            a#approve-user.btn.btn-success.btn-inline.approve 
              span Approve User
              i.fa.fa-user-plus
            a#reject-report.btn.btn-danger.btn-inline.reject 
              span Reject Report
              i.fa.fa-times
      if isOwner
        section.approval.rm-pad.space-btm-3(class="#{report.approval}-wrap")
          .container
            span.approvalStatus(class=report.approval) #{report.approval}
      else 
        .space-btm-3


      +autoForm(
        id="ranavirus-report"
        collection="collections.Reports"
        type=type
        doc=reportDoc
        redirectOnSubmit=urlQuery.redirectOnSubmit
      )

        +afQuickField name='studyId'

        if isInsert
          +afQuickField name='approval' value=userApproval

        section.rm-pad-top
          .container
            +contactInfo

        section.date-location.rm-pad-top
          .container
            h3 Date and Location
            .row.form-input-block
              .col-sm-12
                .row
                  .col-sm-4
                    +afQuickField name="eventDate"
                .row
                  .col-sm-12
                    +afQuickField name="eventLocation"

        section.odd
          .container
            +populationInfo

        section
          .container
            +species numInvolved=true

        section.odd
          .container
            +classesMethods report=true

        section
          .container
            .row.form-input-block
              .col-md-4.col-sm-6.input-block
                +afQuickField name='pathologyReports' id='pathologyReports'
              .col-md-4.col-sm-6.input-block
                +afQuickField name='images' id='images'
              .col-md-4.col-sm-6.input-block
                +afQuickField name='genBankAccessionNumbers' id='genBankAccessionNumbers'

        section.rm-pad-top
          .container
            .row
              .col-sm-9
                +afQuickField name='additionalNotes' id='additionalNotes'

        section.rm-pad-top
          .container
            +permissions

        unless eq type "readonly"
          +submit

  else
    h3 Invalid form id

  unless isInsert
    .review-panel
      .review-panel-header Reviews
      .review-content.hidden-panel
        +reviews reportId=report._id
